DATASET SIZE INFO
Full dataset size: 467985
After model filtering: 213936
model
llama-chat      53484
mpt-chat        53484
mistral-chat    53484
gpt4            26742
cohere-chat     26742
Name: count, dtype: int64

Classes: ['cohere-chat', 'gpt4', 'llama-chat', 'mistral-chat', 'mpt-chat']

Building TF-IDF features...
TF-IDF train: (171148, 2000)  test: (42788, 2000)

Building 56 numeric features...
Processed 0/171148
Processed 5000/171148
Processed 10000/171148
Processed 15000/171148
Processed 20000/171148
Processed 25000/171148
Processed 30000/171148
Processed 35000/171148
Processed 40000/171148
Processed 45000/171148
Processed 50000/171148
Processed 55000/171148
Processed 60000/171148
Processed 65000/171148
Processed 70000/171148
Processed 75000/171148
Processed 80000/171148
Processed 85000/171148
Processed 90000/171148
Processed 95000/171148
Processed 100000/171148
Processed 105000/171148
Processed 110000/171148
Processed 115000/171148
Processed 120000/171148
Processed 125000/171148
Processed 130000/171148
Processed 135000/171148
Processed 140000/171148
Processed 145000/171148
Processed 150000/171148
Processed 155000/171148
Processed 160000/171148
Processed 165000/171148
Processed 170000/171148
Processed 0/42788
Processed 5000/42788
Processed 10000/42788
Processed 15000/42788
Processed 20000/42788
Processed 25000/42788
Processed 30000/42788
Processed 35000/42788
Processed 40000/42788

Combined train: (171148, 2056)  test: (42788, 2056)

Training XGB...
XGB Accuracy: 0.828246237262784
XGB Macro F1: 0.8311015371322821
XGB Confusion Matrix:
 [[3930   81  200  630  507]
 [  42 4824  296  121   66]
 [  87   78 9810  617  105]
 [ 454   88  868 8182 1105]
 [ 353   71  281 1299 8693]]

Training LGBM...
/Users/daniel_ojeda/Desktop/data_mining/venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
LGBM Accuracy: 0.8397681592969991
LGBM Macro F1: 0.84325762681913
LGBM Confusion Matrix:
 [[4070   78  167  568  465]
 [  41 4910  250   96   52]
 [  87   76 9850  563  121]
 [ 439   81  765 8327 1085]
 [ 353   64  234 1271 8775]]

VOTING (XGB + LGBM)...
/Users/daniel_ojeda/Desktop/data_mining/venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
VOTING Accuracy: 0.8384593811348976
VOTING Macro F1: 0.8417871984847423

OOF STACKING (XGB + LGBM)...
OOF fold 1/3
/Users/daniel_ojeda/Desktop/data_mining/venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
OOF fold 2/3
/Users/daniel_ojeda/Desktop/data_mining/venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
OOF fold 3/3
/Users/daniel_ojeda/Desktop/data_mining/venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
/Users/daniel_ojeda/Desktop/data_mining/venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2691: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
STACK Accuracy: 0.8397447882583902
STACK Macro F1: 0.8438886686333538

Done.
 *  Terminal will be reused by tasks, press any key to close it. 
